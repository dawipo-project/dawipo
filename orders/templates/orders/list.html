{% extends 'base.html' %}
{% load static %}
{% load humanize %}
{% block title %}DAWIPO - {% if category %}{{ category.name }}{% else %}Catálogo{% endif %}{% endblock %}
{% block content %}
<div class="row">
	<div class="col-12">
		<div class="page-title-box">
			<div class="page-title-right">
				<ol class="breadcrumb m-0">
					<li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Inicio</a></li>
					<li class="breadcrumb-item {% if not category %}active{% endif %}">Órdenes</li>
					<li class="breadcrumb-item active">Nueva orden</li>
				</ol>
			</div>
			<h4 class="page-title text-comfortaa">
				Escoge los productos que quieres agregar
			</h4>
		</div>
	</div>
</div>
<div class="row">
	<ul class="nav ml-2 mb-2 nav-fill">
		<li class="nav-item mr-2">
			<a href="{% url 'cart:cart_detail' %}" class="btn btn-primary">
				<i class="uil uil-shopping-cart-alt"></i>
				Ver contenido de la orden
			</a>
		</li>
		<li class="nav-item flex-fill" style="width: 14em">
			<select class="form-control form-control-sm select2" data-toggle="select2" style="width: 14em" onchange="location = this.value;">
				<option>Filtrar por categoría</option>
				<optgroup label="Categories">
					{% for category in categories %}
					<option value="{% url 'orders:orders_product_list_by_category' category.slug%}">{{ category.name }}</option>
					{% endfor %}
				</optgroup>
			</select>
		</li>
	</ul>
</div>
<div class="row">
	{% for product in products %}
	<div class="col-sm-12 col-md-6 col-lg-4 col-xl-3 d-flex align-items-stretch">
		<div class="card w-100">
			<img src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'images/no_image.png' %}{% endif %}" alt="{{ product.slug }}" class="card-img-top">
			<div class="card-body">
				<h5 class="card-title"><a href="{{ product.get_absolute_url }}">{{ product.name }}</a></h5>
				<hr>
				<p class="card-text">
					{{ product.description|truncatewords:20 }}
				</p>
				<hr>
				<form action="{% url 'cart:cart_add' product.id %}" method="post">
					{% csrf_token %}
					<div class="form-group">
						<label for="id_price">Precio</label>
						<select name="price" id="id_price" class="form-control select2" data-toggle="select2" required>
							<option value="{{ product.price_1 }}" selected>Precio retail: ${{ product.price_1|intcomma }}</option>
							{% if product.price_2 %}
							<option value="{{ product.price_2 }}">Precio mayorista: ${{ product.price_2|intcomma }}</option>
							{% endif %}
							{% if product.price_3 %}
							<option value="{{ product.price_3 }}">Otro precio: ${{ product.price_3|intcomma }}</option>
							{% endif %}
						</select>
					</div>
					<div class="form-group">
						<label for="id_quantity"></label>
						<input data-toggle="touchspin" type="number" value="1" data-bts-max="100000" required id="id_quantity" name="quantity" data-bts-button-down-class="btn btn-danger" data-bts-button-up-class="btn btn-primary">
						<input type="hidden" name="override" value="False" id="id_override">
					</div>
					<button type="submit" class="btn btn-secondary">
						<i class="uil-plus-circle"></i>
						Agregar a la orden
					</button>
				</form>
			</div>
		</div>
	</div>
	{% endfor %}
</div>
{% endblock %}